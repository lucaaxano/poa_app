@tailwind base;
@tailwind components;
@tailwind utilities;

/* Safe area insets for TWA and phones with notches */
:root {
  --sat: env(safe-area-inset-top, 0px);
  --sar: env(safe-area-inset-right, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
}

@layer base {
  :root {
    /* Background & Foreground */
    --background: 0 0% 100%;
    --foreground: 222 47% 11%;

    /* Card */
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;

    /* Popover */
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;

    /* Primary - Navy/Indigo */
    --primary: 245 58% 20%;
    --primary-foreground: 0 0% 100%;

    /* Secondary */
    --secondary: 210 40% 96%;
    --secondary-foreground: 222 47% 11%;

    /* Muted */
    --muted: 210 40% 96%;
    --muted-foreground: 215 20% 35%;  /* Darkened for WCAG AA compliance (was 215 16% 47%) */

    /* Accent */
    --accent: 210 40% 96%;
    --accent-foreground: 222 47% 11%;

    /* Destructive */
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    /* Border & Input */
    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 245 58% 20%;

    /* Radius - increased for modern look */
    --radius: 1rem;

    /* Claim Status Colors - consistent with mobile (see packages/shared/src/design-tokens.ts) */
    --status-draft-bg: 220 14% 96%;
    --status-draft-text: 217 19% 27%;
    --status-draft-border: 216 12% 84%;

    --status-submitted-bg: 245 100% 94%;
    --status-submitted-text: 245 75% 42%;
    --status-submitted-border: 245 95% 76%;

    --status-approved-bg: 141 84% 93%;
    --status-approved-text: 142 72% 29%;
    --status-approved-border: 142 71% 45%;

    --status-sent-bg: 214 95% 93%;
    --status-sent-text: 221 83% 53%;
    --status-sent-border: 217 91% 60%;

    --status-acknowledged-bg: 138 76% 97%;
    --status-acknowledged-text: 142 76% 36%;
    --status-acknowledged-border: 142 71% 45%;

    --status-closed-bg: 220 14% 96%;
    --status-closed-text: 215 14% 34%;
    --status-closed-border: 218 11% 65%;

    --status-rejected-bg: 0 93% 94%;
    --status-rejected-text: 0 74% 42%;
    --status-rejected-border: 0 84% 60%;
  }

  .dark {
    --background: 222 47% 11%;
    --foreground: 210 40% 98%;

    --card: 222 47% 11%;
    --card-foreground: 210 40% 98%;

    --popover: 222 47% 11%;
    --popover-foreground: 210 40% 98%;

    --primary: 210 40% 98%;
    --primary-foreground: 222 47% 11%;

    --secondary: 217 33% 18%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217 33% 18%;
    --muted-foreground: 215 20% 65%;

    --accent: 217 33% 18%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 63% 31%;
    --destructive-foreground: 210 40% 98%;

    --border: 217 33% 18%;
    --input: 217 33% 18%;
    --ring: 213 27% 84%;
  }
}

/* Native iOS feel inside Capacitor WebView */
body {
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  -webkit-user-select: none;
  user-select: none;
  overscroll-behavior: none;
}

/* Keep inputs and textareas selectable */
input, textarea, [contenteditable="true"], .selectable {
  -webkit-user-select: text;
  user-select: text;
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground antialiased;
    overflow-x: hidden;
  }

  /* Scroll performance optimizations */
  html {
    scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  }

  /* Enable smooth touch scrolling on mobile */
  .overflow-auto,
  .overflow-y-auto,
  .overflow-x-auto,
  .overflow-scroll,
  .overflow-y-scroll,
  .overflow-x-scroll {
    -webkit-overflow-scrolling: touch;
  }

  /* Custom scrollbar styles */
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--border)) transparent;
  }

  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    background-color: hsl(var(--border));
    border-radius: 3px;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background-color: hsl(var(--muted-foreground) / 0.5);
  }

  /* PERFORMANCE FIX: GPU-accelerated scrolling for smooth sidebar */
  .will-change-scroll {
    will-change: scroll-position;
    transform: translateZ(0); /* Force GPU layer */
    backface-visibility: hidden;
  }

  /* PERFORMANCE FIX: CSS containment for list containers */
  /* Isolates paint/layout calculations during scroll */
  .contain-layout {
    contain: layout;
  }

  .contain-paint {
    contain: paint;
  }

  .contain-strict {
    contain: strict;
  }

  /* Content visibility for off-screen content (auto-skip rendering) */
  .content-auto {
    content-visibility: auto;
    contain-intrinsic-size: auto 100px; /* Estimated height for off-screen items */
  }

  /* Optimize table body for large lists */
  tbody {
    contain: layout style;
  }

  /* Optimize list items for scroll performance */
  [role="listitem"],
  [data-list-item] {
    contain: layout style;
  }

  /* PERFORMANCE FIX: Reduce repaints during scroll */
  .scroll-container {
    contain: layout paint;
    isolation: isolate;
  }

  /* PERFORMANCE FIX: Optimize card lists during scroll */
  .space-y-2 > *,
  .space-y-3 > *,
  .space-y-4 > * {
    contain: layout style;
  }

  /* IMPORTANT: Ensure sidebar navigation can scroll even when dialogs are open */
  /* Radix UI adds overflow:hidden to body when modal is open, this overrides it for the sidebar */
  aside nav {
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Prevent body scroll lock from affecting fixed sidebars */
  body[data-scroll-locked] aside {
    pointer-events: auto;
  }
}

/* PERFORMANCE FIX: Optimize transitions for GPU acceleration */
@layer utilities {
  /* Use transform and opacity for transitions (GPU accelerated) */
  .transition-gpu {
    transition-property: transform, opacity;
    will-change: transform, opacity;
  }

  /* Reduce motion for users who prefer it */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  /* PERFORMANCE FIX: Optimized hover states - only transition colors, not layouts */
  .hover-optimized {
    transition: background-color 150ms ease, color 150ms ease, border-color 150ms ease;
  }

  /* PERFORMANCE FIX: Virtual scroll container styles */
  .virtual-list {
    contain: strict;
    will-change: transform;
  }

  .virtual-list-item {
    contain: layout style paint;
    will-change: transform;
  }
}
